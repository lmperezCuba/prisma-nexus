# Migration `20200605173230-seed`

This migration has been generated by lmperez at 6/5/2020, 5:32:30 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP TABLE "public"."country";

DROP TABLE "public"."email";

DROP TABLE "public"."legal_person";

DROP TABLE "public"."legal_person_registry";

DROP TABLE "public"."legal_person_type";

DROP TABLE "public"."migrations";

DROP TABLE "public"."municipality";

DROP TABLE "public"."phone_number";

DROP TABLE "public"."province";

DROP TABLE "public"."structure";

DROP TABLE "public"."unit_of_measurement";

DROP TABLE "public"."unit_of_measurement_quantity";

DROP TABLE "public"."unit_of_measurement_type";

CREATE TABLE "public"."country" (
"code_iso_alpha3" text  NOT NULL ,"code_m49" text  NOT NULL ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"name" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."email" (
"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"enabled" boolean  NOT NULL DEFAULT true,"id" text  NOT NULL ,"legal_person_id" text  NOT NULL ,"scope" text   DEFAULT E'',"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."legal_person" (
"address" text  NOT NULL DEFAULT E'-',"created_at" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"initials" text   DEFAULT E'-',"legal_person_registry_id" text  NOT NULL ,"legal_person_type_id" text  NOT NULL ,"migration_id" integer   ,"municipality_id" text   ,"name" text  NOT NULL ,"registry_code" text  NOT NULL ,"titular" text  NOT NULL DEFAULT E'-',"updated_at" timestamp(3)   DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."legal_person_registry" (
"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"initials" text  NOT NULL ,"name" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."legal_person_type" (
"code" text  NOT NULL ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"initials" text  NOT NULL ,"migration_id" integer   ,"name" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."migrations" (
"id" SERIAL,"name" text  NOT NULL ,"timestamp" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."municipality" (
"code" text   ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"initials" text   ,"migration_id" integer   ,"name" text  NOT NULL ,"province_id" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."phone_number" (
"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"enabled" boolean  NOT NULL DEFAULT true,"id" text  NOT NULL ,"legal_person_id" text  NOT NULL ,"phone_number" text  NOT NULL ,"scope" text   ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."province" (
"code" text  NOT NULL ,"country_id" text  NOT NULL ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"initials" text   ,"migration_id" integer   ,"name" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."structure" (
"attended_by_id" text   ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"legal_person_id" text  NOT NULL ,"migration_id" integer   ,"organization_id" text   ,"parent_id" text   ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."unit_of_measurement" (
"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"denominator" text  NOT NULL ,"description" text   DEFAULT E'-',"detete_at" timestamp(3)   ,"equation_b2uom" text  NOT NULL ,"equation_uom2b" text  NOT NULL ,"id" text  NOT NULL ,"readonly" boolean  NOT NULL DEFAULT true,"symbol" text  NOT NULL ,"unit_of_measurement_type_id" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."unit_of_measurement_quantity" (
"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"enabled" boolean  NOT NULL DEFAULT true,"id" text  NOT NULL ,"quantity" integer  NOT NULL ,"unit_of_measurement_id" text   ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."unit_of_measurement_type" (
"base" text  NOT NULL ,"created_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text   DEFAULT E'',"detete_at" timestamp(3)   ,"id" text  NOT NULL ,"type" text  NOT NULL ,"updated_at" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"version" integer  NOT NULL DEFAULT 1,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "country.code_iso_alpha3" ON "public"."country"("code_iso_alpha3")

CREATE UNIQUE INDEX "country.code_m49" ON "public"."country"("code_m49")

CREATE UNIQUE INDEX "country.name" ON "public"."country"("name")

CREATE  INDEX "IDX_8eef18cb087005e9604d63d4fa" ON "public"."country"("code_m49")

CREATE  INDEX "IDX_bf6e37c231c4f4ea56dcd88726" ON "public"."country"("id")

CREATE  INDEX "IDX_e86582c8268b3b73a8c7fe3019" ON "public"."country"("code_iso_alpha3")

CREATE UNIQUE INDEX "email.email" ON "public"."email"("email")

CREATE  INDEX "IDX_1e7ed8734ee054ef18002e29b1" ON "public"."email"("id")

CREATE UNIQUE INDEX "legal_person.registry_code" ON "public"."legal_person"("registry_code")

CREATE  INDEX "IDX_04472abeaba63dcc96bb6f01f1" ON "public"."legal_person"("migration_id")

CREATE  INDEX "IDX_8dfae52c957b869f8552389917" ON "public"."legal_person"("initials")

CREATE  INDEX "IDX_f74fd434bd5c87419aedfd683b" ON "public"."legal_person"("id")

CREATE UNIQUE INDEX "legal_person_registry.initials" ON "public"."legal_person_registry"("initials")

CREATE  INDEX "IDX_c04a255761b1e2e5c60844b0e3" ON "public"."legal_person_registry"("id")

CREATE  INDEX "IDX_f89de586d142be71940458b718" ON "public"."legal_person_registry"("initials")

CREATE UNIQUE INDEX "legal_person_type.code" ON "public"."legal_person_type"("code")

CREATE UNIQUE INDEX "legal_person_type.initials" ON "public"."legal_person_type"("initials")

CREATE UNIQUE INDEX "legal_person_type.migration_id" ON "public"."legal_person_type"("migration_id")

CREATE  INDEX "IDX_4ee875c96f8db2dfa956f1a441" ON "public"."legal_person_type"("migration_id")

CREATE  INDEX "IDX_af4a2bb7549c045567be4c0a2d" ON "public"."legal_person_type"("id")

CREATE  INDEX "IDX_be41e77280422809b3f61d95cd" ON "public"."legal_person_type"("initials")

CREATE  INDEX "IDX_d52b92d07a9542316648519a2f" ON "public"."legal_person_type"("code")

CREATE UNIQUE INDEX "municipality.code" ON "public"."municipality"("code")

CREATE UNIQUE INDEX "municipality.migration_id" ON "public"."municipality"("migration_id")

CREATE  INDEX "IDX_206cef1bf4f5cf66bea60fd94c" ON "public"."municipality"("migration_id")

CREATE  INDEX "IDX_281ad341f20df7c41b83a182e2" ON "public"."municipality"("id")

CREATE  INDEX "IDX_f01eb47e7b81481ca5a146a786" ON "public"."municipality"("code")

CREATE  INDEX "IDX_c16f58426537a660b3f2a26e98" ON "public"."phone_number"("id")

CREATE UNIQUE INDEX "province.code" ON "public"."province"("code")

CREATE UNIQUE INDEX "province.initials" ON "public"."province"("initials")

CREATE UNIQUE INDEX "province.migration_id" ON "public"."province"("migration_id")

CREATE UNIQUE INDEX "province.name" ON "public"."province"("name")

CREATE  INDEX "IDX_3288dfa18d390ed33b359fc041" ON "public"."province"("code")

CREATE  INDEX "IDX_4f461cb46f57e806516b707365" ON "public"."province"("id")

CREATE  INDEX "IDX_6a3d8060b848bee37e22625d3b" ON "public"."province"("migration_id")

CREATE UNIQUE INDEX "structure.legal_person_id" ON "public"."structure"("legal_person_id")

CREATE  INDEX "IDX_48814b20d81ecad5009607e806" ON "public"."structure"("migration_id")

CREATE  INDEX "IDX_90ac7986e769d602d218075215" ON "public"."structure"("id")

CREATE UNIQUE INDEX "unit_of_measurement.denominator" ON "public"."unit_of_measurement"("denominator")

CREATE UNIQUE INDEX "unit_of_measurement.symbol" ON "public"."unit_of_measurement"("symbol")

CREATE  INDEX "IDX_44349d16c109aa8ac1ee2726d5" ON "public"."unit_of_measurement"("id")

CREATE  INDEX "IDX_6a7033c82093f0a844cb5a5b99" ON "public"."unit_of_measurement"("symbol")

CREATE  INDEX "IDX_fd8ec744bdfc11e13aef9b4d67" ON "public"."unit_of_measurement"("denominator")

CREATE UNIQUE INDEX "unit_of_measurement_quantity.quantity" ON "public"."unit_of_measurement_quantity"("quantity")

CREATE  INDEX "IDX_4c33cc77374f957930257b4623" ON "public"."unit_of_measurement_quantity"("id")

CREATE UNIQUE INDEX "unit_of_measurement_type.base" ON "public"."unit_of_measurement_type"("base")

CREATE UNIQUE INDEX "unit_of_measurement_type.type" ON "public"."unit_of_measurement_type"("type")

CREATE  INDEX "IDX_a0dd0b46505bdb0b0a9da2ea58" ON "public"."unit_of_measurement_type"("id")

ALTER TABLE "public"."email" ADD FOREIGN KEY ("legal_person_id")REFERENCES "public"."legal_person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."legal_person" ADD FOREIGN KEY ("legal_person_registry_id")REFERENCES "public"."legal_person_registry"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."legal_person" ADD FOREIGN KEY ("legal_person_type_id")REFERENCES "public"."legal_person_type"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."legal_person" ADD FOREIGN KEY ("municipality_id")REFERENCES "public"."municipality"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."municipality" ADD FOREIGN KEY ("province_id")REFERENCES "public"."province"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."phone_number" ADD FOREIGN KEY ("legal_person_id")REFERENCES "public"."legal_person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."province" ADD FOREIGN KEY ("country_id")REFERENCES "public"."country"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."structure" ADD FOREIGN KEY ("attended_by_id")REFERENCES "public"."structure"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."structure" ADD FOREIGN KEY ("legal_person_id")REFERENCES "public"."legal_person"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."structure" ADD FOREIGN KEY ("organization_id")REFERENCES "public"."structure"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."structure" ADD FOREIGN KEY ("parent_id")REFERENCES "public"."structure"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."unit_of_measurement" ADD FOREIGN KEY ("unit_of_measurement_type_id")REFERENCES "public"."unit_of_measurement_type"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."unit_of_measurement_quantity" ADD FOREIGN KEY ("unit_of_measurement_id")REFERENCES "public"."unit_of_measurement"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200605173230-seed
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,226 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model country {
+  code_iso_alpha3 String     @unique
+  code_m49        String     @unique
+  created_at      DateTime   @default(now())
+  detete_at       DateTime?
+  id              String     @default(dbgenerated()) @id
+  name            String     @unique
+  updated_at      DateTime   @default(now())
+  version         Int        @default(1)
+  province        province[]
+
+  @@index([code_m49], name: "IDX_8eef18cb087005e9604d63d4fa")
+  @@index([id], name: "IDX_bf6e37c231c4f4ea56dcd88726")
+  @@index([code_iso_alpha3], name: "IDX_e86582c8268b3b73a8c7fe3019")
+}
+
+model email {
+  created_at      DateTime     @default(now())
+  email           String       @unique
+  enabled         Boolean      @default(true)
+  id              String       @default(dbgenerated()) @id
+  legal_person_id String
+  scope           String?      @default("")
+  updated_at      DateTime     @default(now())
+  version         Int          @default(1)
+  legal_person    legal_person @relation(fields: [legal_person_id], references: [id])
+
+  @@index([id], name: "IDX_1e7ed8734ee054ef18002e29b1")
+}
+
+model legal_person {
+  address                  String                @default("-")
+  created_at               DateTime?             @default(now())
+  detete_at                DateTime?
+  id                       String                @default(dbgenerated()) @id
+  initials                 String?               @default("-")
+  legal_person_registry_id String
+  legal_person_type_id     String
+  migration_id             Int?
+  municipality_id          String?
+  name                     String
+  registry_code            String                @unique
+  titular                  String                @default("-")
+  updated_at               DateTime?             @default(now())
+  version                  Int                   @default(1)
+  legal_person_registry    legal_person_registry @relation(fields: [legal_person_registry_id], references: [id])
+  legal_person_type        legal_person_type     @relation(fields: [legal_person_type_id], references: [id])
+  municipality             municipality?         @relation(fields: [municipality_id], references: [id])
+  email                    email[]
+  phone_number             phone_number[]
+  structure                structure?
+
+  @@index([migration_id], name: "IDX_04472abeaba63dcc96bb6f01f1")
+  @@index([initials], name: "IDX_8dfae52c957b869f8552389917")
+  @@index([id], name: "IDX_f74fd434bd5c87419aedfd683b")
+}
+
+model legal_person_registry {
+  created_at   DateTime       @default(now())
+  detete_at    DateTime?
+  id           String         @default(dbgenerated()) @id
+  initials     String         @unique
+  name         String
+  updated_at   DateTime       @default(now())
+  version      Int            @default(1)
+  legal_person legal_person[]
+
+  @@index([id], name: "IDX_c04a255761b1e2e5c60844b0e3")
+  @@index([initials], name: "IDX_f89de586d142be71940458b718")
+}
+
+model legal_person_type {
+  code         String         @unique
+  created_at   DateTime       @default(now())
+  detete_at    DateTime?
+  id           String         @default(dbgenerated()) @id
+  initials     String         @unique
+  migration_id Int?           @unique
+  name         String
+  updated_at   DateTime       @default(now())
+  version      Int            @default(1)
+  legal_person legal_person[]
+
+  @@index([migration_id], name: "IDX_4ee875c96f8db2dfa956f1a441")
+  @@index([id], name: "IDX_af4a2bb7549c045567be4c0a2d")
+  @@index([initials], name: "IDX_be41e77280422809b3f61d95cd")
+  @@index([code], name: "IDX_d52b92d07a9542316648519a2f")
+}
+
+model migrations {
+  id        Int    @default(autoincrement()) @id
+  name      String
+  timestamp Int
+}
+
+model municipality {
+  code         String?        @unique
+  created_at   DateTime       @default(now())
+  detete_at    DateTime?
+  id           String         @default(dbgenerated()) @id
+  initials     String?
+  migration_id Int?           @unique
+  name         String
+  province_id  String
+  updated_at   DateTime       @default(now())
+  version      Int            @default(1)
+  province     province       @relation(fields: [province_id], references: [id])
+  legal_person legal_person[]
+
+  @@index([migration_id], name: "IDX_206cef1bf4f5cf66bea60fd94c")
+  @@index([id], name: "IDX_281ad341f20df7c41b83a182e2")
+  @@index([code], name: "IDX_f01eb47e7b81481ca5a146a786")
+}
+
+model phone_number {
+  created_at      DateTime     @default(now())
+  enabled         Boolean      @default(true)
+  id              String       @default(dbgenerated()) @id
+  legal_person_id String
+  phone_number    String
+  scope           String?
+  updated_at      DateTime     @default(now())
+  version         Int          @default(1)
+  legal_person    legal_person @relation(fields: [legal_person_id], references: [id])
+
+  @@index([id], name: "IDX_c16f58426537a660b3f2a26e98")
+}
+
+model province {
+  code         String         @unique
+  country_id   String
+  created_at   DateTime       @default(now())
+  detete_at    DateTime?
+  id           String         @default(dbgenerated()) @id
+  initials     String?        @unique
+  migration_id Int?           @unique
+  name         String         @unique
+  updated_at   DateTime       @default(now())
+  version      Int            @default(1)
+  country      country        @relation(fields: [country_id], references: [id])
+  municipality municipality[]
+
+  @@index([code], name: "IDX_3288dfa18d390ed33b359fc041")
+  @@index([id], name: "IDX_4f461cb46f57e806516b707365")
+  @@index([migration_id], name: "IDX_6a3d8060b848bee37e22625d3b")
+}
+
+model structure {
+  attended_by_id                                       String?
+  created_at                                           DateTime     @default(now())
+  detete_at                                            DateTime?
+  id                                                   String       @default(dbgenerated()) @id
+  legal_person_id                                      String       @unique
+  migration_id                                         Int?
+  organization_id                                      String?
+  parent_id                                            String?
+  updated_at                                           DateTime     @default(now())
+  version                                              Int          @default(1)
+  structure_structureTostructure_attended_by_id        structure?   @relation("structureTostructure_attended_by_id", fields: [attended_by_id], references: [id])
+  legal_person                                         legal_person @relation(fields: [legal_person_id], references: [id])
+  structure_structureTostructure_organization_id       structure?   @relation("structureTostructure_organization_id", fields: [organization_id], references: [id])
+  structure_structureTostructure_parent_id             structure?   @relation("structureTostructure_parent_id", fields: [parent_id], references: [id])
+  other_structure_structureTostructure_attended_by_id  structure[]  @relation("structureTostructure_attended_by_id")
+  other_structure_structureTostructure_organization_id structure[]  @relation("structureTostructure_organization_id")
+  other_structure_structureTostructure_parent_id       structure[]  @relation("structureTostructure_parent_id")
+
+  @@index([migration_id], name: "IDX_48814b20d81ecad5009607e806")
+  @@index([id], name: "IDX_90ac7986e769d602d218075215")
+}
+
+model unit_of_measurement {
+  created_at                   DateTime                       @default(now())
+  denominator                  String                         @unique
+  description                  String?                        @default("-")
+  detete_at                    DateTime?
+  equation_b2uom               String
+  equation_uom2b               String
+  id                           String                         @default(dbgenerated()) @id
+  readonly                     Boolean                        @default(true)
+  symbol                       String                         @unique
+  unit_of_measurement_type_id  String
+  updated_at                   DateTime                       @default(now())
+  version                      Int                            @default(1)
+  unit_of_measurement_type     unit_of_measurement_type       @relation(fields: [unit_of_measurement_type_id], references: [id])
+  unit_of_measurement_quantity unit_of_measurement_quantity[]
+
+  @@index([id], name: "IDX_44349d16c109aa8ac1ee2726d5")
+  @@index([symbol], name: "IDX_6a7033c82093f0a844cb5a5b99")
+  @@index([denominator], name: "IDX_fd8ec744bdfc11e13aef9b4d67")
+}
+
+model unit_of_measurement_quantity {
+  created_at             DateTime             @default(now())
+  enabled                Boolean              @default(true)
+  id                     String               @default(dbgenerated()) @id
+  quantity               Int                  @unique
+  unit_of_measurement_id String?
+  updated_at             DateTime             @default(now())
+  version                Int                  @default(1)
+  unit_of_measurement    unit_of_measurement? @relation(fields: [unit_of_measurement_id], references: [id])
+
+  @@index([id], name: "IDX_4c33cc77374f957930257b4623")
+}
+
+model unit_of_measurement_type {
+  base                String                @unique
+  created_at          DateTime              @default(now())
+  description         String?               @default("")
+  detete_at           DateTime?
+  id                  String                @default(dbgenerated()) @id
+  type                String                @unique
+  updated_at          DateTime              @default(now())
+  version             Int                   @default(1)
+  unit_of_measurement unit_of_measurement[]
+
+  @@index([id], name: "IDX_a0dd0b46505bdb0b0a9da2ea58")
+}
```


